'use strict';

const tap = require('tap');

const timingSafeCompare = require('../app/timing-safe-compare').timingSafeCompare;

const a = Buffer.from([
	0x1e, 0xe8, 0x89, 0x9a, 0xee, 0xa2, 0xf1, 0xe9,
	0x02, 0x3b, 0x42, 0x59, 0x23, 0xbb, 0x3f, 0x86,
	0xf8, 0xfa,
]);

const b = Buffer.from([
	0x1e, 0xe8, 0x89, 0x9a, 0xee, 0xa2, 0xf1, 0xe9,
	0x02, 0x3b, 0x42, 0x59, 0x23, 0xbb, 0x3f, 0x86,
	0xf8, 0xfa,
]);

const c = Buffer.from([
	0x1e, 0xe8, 0x89, 0x9a, 0xee, 0x82, 0xf1, 0xe9,
	0x02, 0x3b, 0x42, 0x59, 0x23, 0xbb, 0x3f, 0x86,
	0xf8, 0xfa,
]);

const empty = Buffer.alloc(0);

tap.test('Equal buffers should compare as equal', function (t) {
	t.ok(timingSafeCompare(a, a));
	t.ok(timingSafeCompare(a, b));
	t.ok(timingSafeCompare(empty, Buffer.alloc(0)));
	t.end();
});

tap.test('Unequal buffers should compare as unequal', function (t) {
	t.notOk(timingSafeCompare(a, c));
	t.notOk(timingSafeCompare(a, empty));
	t.end();
});
